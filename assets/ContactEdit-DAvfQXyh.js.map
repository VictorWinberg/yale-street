{"version":3,"file":"ContactEdit-DAvfQXyh.js","sources":["../../src/features/contacts/components/ContactEdit.tsx"],"sourcesContent":["import { useMemo } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\n\n// material-ui\nimport { Box, Typography } from '@mui/material';\n\n// project imports\nimport { Contact } from '@/api/gql/graphql';\nimport AssignmentTable from '@/features/assignments/components/AssignmentTable';\nimport { useAssignments } from '@/features/assignments/hooks/useAssignmentsQueries';\nimport InteractionTable from '@/features/interactions/components/InteractionTable';\nimport { useInteractions } from '@/features/interactions/hooks/useInteractionsQueries';\nimport { headerHeight } from '@/store/constant';\nimport ContentTabs from '@/ui-component/ContentTabs';\nimport FlexGrow from '@/ui-component/extended/FlexGrow';\nimport { FormActionButtons } from '@/ui-component/SebraForm';\nimport { formatDate } from '@/utils';\nimport { useCreateContact, useDeleteContact, useUpdateContact } from '../hooks/useContactsMutations';\nimport { useContact } from '../hooks/useContactsQueries';\nimport ContactForm from './ContactForm';\n\n// ==============================|| CONTACT EDIT PAGE ||============================== //\n\nconst ContactEdit = () => {\n  const params = useParams();\n  const navigate = useNavigate();\n\n  const { data: contact, isLoading } = useContact(params.id === 'new' ? undefined : params.id);\n  const { mutate: createContact } = useCreateContact();\n  const { mutate: updateContact } = useUpdateContact();\n  const { mutate: deleteContact } = useDeleteContact();\n\n  const { data: allAssignments = [], isLoading: assignmentsIsLoading } = useAssignments();\n  const assignments = useMemo(\n    () =>\n      allAssignments.filter(\n        (assignment) =>\n          assignment.responsibleContacts?.some((c) => c.id === contact?.id) ||\n          assignment.externalContact?.id === contact?.id\n      ),\n    [allAssignments, contact]\n  );\n  const { data: allInteractions = [], isLoading: interactionsIsLoading } = useInteractions();\n  const interactions = useMemo(\n    () => allInteractions.filter((interaction) => interaction.contacts?.some((c) => c.id === contact?.id)),\n    [allInteractions, contact]\n  );\n\n  const handleSubmit = (data: Contact) => {\n    if (contact) {\n      updateContact({ ...data, id: contact.id });\n    } else {\n      createContact(data, { onSuccess: ({ createContact }) => navigate(`/home/contacts/${createContact?.id || ''}`) });\n    }\n  };\n\n  if (isLoading) return;\n\n  return (\n    <ContactForm\n      formProps={{ values: contact }}\n      onSubmit={handleSubmit}\n      renderTopContent={() => (\n        <Box sx={{ position: 'relative', mt: 1, mb: 3 }}>\n          <Typography variant=\"h4\" color=\"primary\">\n            {contact ? 'Redigera kontakt' : 'LÃ¤gg till kontakt'}\n          </Typography>\n\n          <FormActionButtons\n            sx={{ position: 'absolute', top: 0, right: 0 }}\n            onDelete={contact ? () => deleteContact(contact, { onSuccess: () => navigate('..') }) : undefined}\n            onCancel={() => navigate(-1)}\n          />\n        </Box>\n      )}\n      renderBottomContent={() =>\n        contact && (\n          <FlexGrow sx={{ mt: 1, minHeight: `calc(100vh - ${headerHeight}px - 1rem)` }}>\n            <ContentTabs\n              tabs={[\n                {\n                  id: 'interactions',\n                  label: 'Interaktioner',\n                  content: (\n                    <InteractionTable\n                      interactions={interactions}\n                      isLoading={interactionsIsLoading}\n                      defaultValues={{ contacts: [contact], interactionDate: formatDate() }}\n                    />\n                  )\n                },\n                {\n                  id: 'assignments',\n                  label: 'Uppdrag',\n                  content: <AssignmentTable assignments={assignments} isLoading={assignmentsIsLoading} />\n                }\n              ]}\n            />\n          </FlexGrow>\n        )\n      }\n    />\n  );\n};\n\nexport default ContactEdit;\n"],"names":["ContactEdit","params","useParams","navigate","useNavigate","contact","isLoading","useContact","createContact","useCreateContact","updateContact","useUpdateContact","deleteContact","useDeleteContact","allAssignments","assignmentsIsLoading","useAssignments","assignments","useMemo","assignment","_a","c","_b","allInteractions","interactionsIsLoading","useInteractions","interactions","interaction","handleSubmit","data","jsx","ContactForm","jsxs","Box","Typography","FormActionButtons","FlexGrow","headerHeight","ContentTabs","InteractionTable","formatDate","AssignmentTable"],"mappings":"urCAuBA,MAAMA,GAAc,IAAM,CACxB,MAAMC,EAASC,IACTC,EAAWC,IAEX,CAAE,KAAMC,EAAS,UAAAC,CAAU,EAAIC,EAAWN,EAAO,KAAO,MAAQ,OAAYA,EAAO,EAAE,EACrF,CAAE,OAAQO,CAAc,EAAIC,EAAiB,EAC7C,CAAE,OAAQC,CAAc,EAAIC,EAAiB,EAC7C,CAAE,OAAQC,CAAc,EAAIC,EAAiB,EAE7C,CAAE,KAAMC,EAAiB,CAAA,EAAI,UAAWC,CAAA,EAAyBC,IACjEC,EAAcC,EAAA,QAClB,IACEJ,EAAe,OACZK,GACC,SAAA,QAAAC,EAAAD,EAAW,sBAAX,YAAAC,EAAgC,KAAMC,GAAMA,EAAE,MAAOhB,GAAA,YAAAA,EAAS,SAC9DiB,EAAAH,EAAW,kBAAX,YAAAG,EAA4B,OAAOjB,GAAA,YAAAA,EAAS,IAChD,EACF,CAACS,EAAgBT,CAAO,CAAA,EAEpB,CAAE,KAAMkB,EAAkB,CAAA,EAAI,UAAWC,CAAA,EAA0BC,IACnEC,EAAeR,EAAA,QACnB,IAAMK,EAAgB,OAAQI,UAAgB,OAAAP,EAAAO,EAAY,WAAZ,YAAAP,EAAsB,KAAMC,GAAMA,EAAE,MAAOhB,GAAA,YAAAA,EAAS,KAAG,EACrG,CAACkB,EAAiBlB,CAAO,CAAA,EAGrBuB,EAAgBC,GAAkB,CAClCxB,EACFK,EAAc,CAAE,GAAGmB,EAAM,GAAIxB,EAAQ,GAAI,EAEzCG,EAAcqB,EAAM,CAAE,UAAW,CAAC,CAAE,cAAArB,CAAoB,IAAAL,EAAS,mBAAkBK,GAAAA,YAAAA,EAAe,KAAM,EAAE,EAAE,EAAG,CACjH,EAGE,GAAA,CAAAF,EAGF,OAAAwB,EAAA,IAACC,EAAA,CACC,UAAW,CAAE,OAAQ1B,CAAQ,EAC7B,SAAUuB,EACV,iBAAkB,IACfI,EAAA,KAAAC,EAAA,CAAI,GAAI,CAAE,SAAU,WAAY,GAAI,EAAG,GAAI,CAAA,EAC1C,SAAA,CAAAH,EAAAA,IAACI,GAAW,QAAQ,KAAK,MAAM,UAC5B,SAAA7B,EAAU,mBAAqB,mBAClC,CAAA,EAEAyB,EAAA,IAACK,EAAA,CACC,GAAI,CAAE,SAAU,WAAY,IAAK,EAAG,MAAO,CAAE,EAC7C,SAAU9B,EAAU,IAAMO,EAAcP,EAAS,CAAE,UAAW,IAAMF,EAAS,IAAI,CAAG,CAAA,EAAI,OACxF,SAAU,IAAMA,EAAS,EAAE,CAAA,CAC7B,CAAA,EACF,EAEF,oBAAqB,IACnBE,GACEyB,EAAAA,IAACM,EAAS,CAAA,GAAI,CAAE,GAAI,EAAG,UAAW,gBAAgBC,CAAY,cAC5D,SAAAP,EAAA,IAACQ,EAAA,CACC,KAAM,CACJ,CACE,GAAI,eACJ,MAAO,gBACP,QACER,EAAA,IAACS,EAAA,CACC,aAAAb,EACA,UAAWF,EACX,cAAe,CAAE,SAAU,CAACnB,CAAO,EAAG,gBAAiBmC,GAAa,CAAA,CACtE,CAEJ,EACA,CACE,GAAI,cACJ,MAAO,UACP,QAASV,EAAA,IAACW,EAAgB,CAAA,YAAAxB,EAA0B,UAAWF,EAAsB,CACvF,CACF,CAAA,CAAA,EAEJ,CAAA,CAAA,CAKV"}